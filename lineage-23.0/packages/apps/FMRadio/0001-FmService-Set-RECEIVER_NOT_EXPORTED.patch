From 4c831eb011139b82fc9fe2d8605e4c4994058e77 Mon Sep 17 00:00:00 2001
From: Cyber Knight <cyberknight755@gmail.com>
Date: Sat, 5 Jul 2025 18:59:11 +0800
Subject: [PATCH 1/2] FmService: Set RECEIVER_NOT_EXPORTED

Change-Id: I00627c63d1da2a9a91585e3ff5ae55d260076fce
Signed-off-by: Cyber Knight <cyberknight755@gmail.com>
---
 src/com/android/fmradio/FmService.java | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/com/android/fmradio/FmService.java b/src/com/android/fmradio/FmService.java
index 18a698f..7205647 100644
--- a/src/com/android/fmradio/FmService.java
+++ b/src/com/android/fmradio/FmService.java
@@ -1360,7 +1360,7 @@ public class FmService extends Service implements FmRecorder.OnRecorderStateChan
         mMediaButtonIntentReceiver.setMediaHandleListener(listener);
         IntentFilter filter = new IntentFilter(Intent.ACTION_MEDIA_BUTTON);
         filter.setPriority(IntentFilter.SYSTEM_HIGH_PRIORITY);
-        registerReceiver(mMediaButtonIntentReceiver, filter);
+        registerReceiver(mMediaButtonIntentReceiver, filter, Context.RECEIVER_NOT_EXPORTED);
         mMediaSession = new MediaSession(mContext, TAG);
         Intent i = new Intent(this, FMMediaButtonIntentReceiver.class)
                 .setFlags(Intent.FLAG_RECEIVER_FOREGROUND);
@@ -1580,7 +1580,7 @@ public class FmService extends Service implements FmRecorder.OnRecorderStateChan
         filter.addAction(Intent.ACTION_SCREEN_OFF);
         filter.addAction(Intent.ACTION_HEADSET_PLUG);
         mBroadcastReceiver = new FmServiceBroadcastReceiver();
-        registerReceiver(mBroadcastReceiver, filter);
+        registerReceiver(mBroadcastReceiver, filter, Context.RECEIVER_NOT_EXPORTED);
     }
 
     private void unregisterFmBroadcastReceiver() {
@@ -2041,7 +2041,7 @@ public class FmService extends Service implements FmRecorder.OnRecorderStateChan
         filter.addAction(Intent.ACTION_MEDIA_MOUNTED);
         filter.addAction(Intent.ACTION_MEDIA_UNMOUNTED);
         filter.addAction(Intent.ACTION_MEDIA_EJECT);
-        registerReceiver(mSdcardListener, filter);
+        registerReceiver(mSdcardListener, filter, Context.RECEIVER_NOT_EXPORTED);
     }
 
     private void unregisterSdcardListener() {
-- 
2.47.3

